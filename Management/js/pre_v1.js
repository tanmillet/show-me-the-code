function getScrollTop(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}function getWindowHeight(){var a=window,b=document,c=b.documentElement,d=b.body;return a.innerHeight||c.clientHeight||d.clientHeight}function scrollCallback(){var a=document.getElementById("nav"),b=getScrollTop()+getWindowHeight();b<document.body.scrollHeight+220&&(a.style.top=(b-220).toString()+"px")}function scrollToAnchor(a){var b,c,d,e,f,g=getScrollTop(),h=a,i=h>g?h-g:g-h;if(100>i)return scrollTo(0,h),void 0;if(b=Math.round(i/100),b>=20&&(b=20),c=Math.round(i/25),d=h>g?g+c:g-c,e=0,h>g)for(f=g;h>f;f+=c)setTimeout("window.scrollTo(0, "+d+")",e*b),d+=c,d>h&&(d=h),e++;else for(f=g;f>h;f-=c)setTimeout("window.scrollTo(0, "+d+")",e*b),d-=c,h>d&&(d=h),e++}function appendQuestionRows(a,b,c,d){var e,f,g,h,i,j,k,l=["scoresCell","scoresCell","yourScoresCell","domainCell"],m=2;for(e=1;e<b.length;++e){if(f=document.createElement("tr"),g=document.createElement("th"),g.innerHTML=b[e],g.className="scoresTitle",f.appendChild(g),h=c[e-1],e==m)for(i=0;d>i;++i)j=document.createElement("td"),k=h[i],j.innerHTML=k,j.className=0==k||"F"==k.toUpperCase()?"yourFailedScoresCell":l[e],f.appendChild(j);else for(i=0;d>i;++i)j=document.createElement("td"),j.innerHTML=h[i],j.className=l[e],f.appendChild(j);a.appendChild(f)}}function appendQuestionNumberRow(a,b,c,d){var e,f,g=document.createElement("tr"),h=document.createElement("th");for(h.innerHTML=b,h.className="scoresTitle",g.appendChild(h),e=c;d>e;++e)f=document.createElement("th"),f.innerHTML=e.toString(),f.className="scoresTitle",g.appendChild(f);a.appendChild(g)}function LoadTable(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=document.getElementById("tableWrapper"),t=a._paperTemplate._questionTypeIndexes,u=a._paperTemplate._domainAnalysisTemplate;for(b=0;b<t.length;++b)if(c=t[b],d=a._paperTemplate._quesTypeTemplate[c],e=getRange(d),f=e.start,g=e.end,g>f){for(h=d.labels.split(","),i=d.values.split(","),j=a._selfDetail[c].print,k=d.domains.split(","),l=[],m=0;m<k.length;++m)n=k[m],l.push(u[n].name);o=document.createElement("div"),o.innerHTML="<a>"+(b+1)+"、"+c+"</a>",o.className="answerTitle tableTitle",p=document.createElement("table"),p.className="scoresTable",appendQuestionNumberRow(p,h[0],f,g),q=[i,j,l],appendQuestionRows(p,h,q,g-f),r=document.createElement("div"),r.className="tableInnerWrapper",r.appendChild(p),s.appendChild(o),s.appendChild(r)}}function getRange(a){var b=a.range.split("-"),c=1,d=0;return 2==b.length&&(c=parseInt(b[0]),d=parseInt(b[1])+1),(isNaN(c)||isNaN(d)||c>=d)&&(c=1,d=parseInt(a.count)+1),{start:c,end:d}}function LoadQuesTypeScoreTableColumn(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=score._paperTemplate._questionTypeIndexes,q=a[p.length][Scores.shared_mapNames[0]],r=document.getElementById("yourScore"),s=a[p.length][Scores.shared_mapNames[3]];for(r.firstElementChild.innerHTML=s,r.style.width=r.offsetWidth+160*(s/q)+"px",r.style.backgroundColor="#ff7d1a",b=document.getElementById("schoolAvgScore"),c=a[p.length][Scores.shared_mapNames[1]],b.firstElementChild.innerHTML=c.toFixed(2),b.style.width=b.offsetWidth+160*(c/q)+"px",b.style.backgroundColor="#3d8cff",d=document.getElementById("allAvgScore"),e=a[p.length][Scores.shared_mapNames[2]],d.firstElementChild.innerHTML=e.toFixed(2),d.style.width=d.offsetWidth+160*(e/q)+"px",d.style.backgroundColor="#1FC20E",f=document.getElementById("quesTypeTable"),g=document.createElement("table"),g.className="scoresTable",h=document.createElement("tr"),i="<th class='scoresTitle'>题目类型</th>",j=0;j<Scores.shared_scoreLabels.length;++j)i+="<th class='scoresTitle'>"+Scores.shared_scoreLabels[j]+"</th> ";for(h.innerHTML=i,g.appendChild(h),k=["fullScoreCell","schoolAvgCell","regionAvgCell","urCell"],l=0;l<p.length+1;++l){for(m=document.createElement("tr"),n=document.createElement("th"),n.className="scoresTitle",n.innerHTML=l==p.length?"您的总分":p[l],m.appendChild(n),j=0;j<Scores.shared_scoreLabels.length;++j)o=document.createElement("td"),o.className=k[j],o.innerHTML=j>0&&j<Scores.shared_scoreLabels.length-1?a[l][j].toFixed(2):a[l][j],m.appendChild(o);g.appendChild(m)}f.appendChild(g)}function LoadDomainTypeTableColumn(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=score._paperTemplate._domainAnalysisIndexes,v=a[u.length][Scores.shared_mapNames[0]],w=document.getElementById("yourDomain"),x=a[u.length][Scores.shared_mapNames[3]];for(w.firstElementChild.innerHTML=x,w.style.width=w.offsetWidth+160*(x/v)+"px",w.style.backgroundColor="#ff7d1a",b=document.getElementById("schoolAvgDomain"),c=a[u.length][Scores.shared_mapNames[1]],b.firstElementChild.innerHTML=c.toFixed(2),b.style.width=b.offsetWidth+160*(c/v)+"px",b.style.backgroundColor="#3d8cff",d=document.getElementById("allAvgDomain"),e=a[u.length][Scores.shared_mapNames[2]],d.firstElementChild.innerHTML=e.toFixed(2),d.style.width=d.offsetWidth+160*(e/v)+"px",d.style.backgroundColor="#1FC20E",f=document.getElementById("domainTable"),g=document.createElement("table"),g.className="scoresTable",h=[],i=0;i<u.length;++i)j=a[i],k=j[Scores.shared_mapNames[0]],0==k?(gShared_accuracy.push(0),h.push("/")):(l=100*j[Scores.shared_mapNames[3]]/j[Scores.shared_mapNames[0]],gShared_accuracy.push(l),h.push(l.toFixed(1)+"%"));for(i=0;i<u.length;++i)gShared_domainNames.push(score._paperTemplate._domainAnalysisTemplate[u[i]].name);for(m=document.createElement("tr"),n="<th class='scoresTitle'>本次试卷领域分析</th>",o=0;o<Scores.shared_domainLabels.length;++o)n+="<th class='scoresTitle'>"+Scores.shared_domainLabels[o]+"</th> ";for(n+="<th class='scoresTitle'>正确率</th> ",m.innerHTML=n,g.appendChild(m),p=["fullScoreCell","schoolAvgCell","regionAvgCell","urCell","urCell"],q=0;q<u.length+1;++q){for(r=document.createElement("tr"),s="<th class='scoresTitle'>"+(q==u.length?"总题数":gShared_domainNames[q])+"</th>",t=Scores.shared_domainLabels.length+1,o=0;t>o;++o)s+=0==o||o==t-2?"<td class='"+p[o]+"'>"+a[q][o]+"</td>":o==t-1?q<u.length?"<td class='"+p[o]+"'>"+h[q]+"</td>":"<td class='"+p[o]+"'></td>":"<td class='"+p[o]+"'>"+a[q][o].toFixed(2)+"</td>";r.innerHTML=s,g.appendChild(r)}f.appendChild(g)}var PaperTemplate,Scores,gShared_accuracy,gShared_domainNames;this.tablecloth=function(){var a,b=!0,c=!1,d=!0;this.clickAction=function(){},a=!1,this.start=function(){var b,c=document.getElementsByClassName("scoresTable");for(b=0;b<c.length;b++)c[b].onmouseover=function(){a=!0},c[b].onmouseout=function(){a=!1},rows(c[b])},this.rows=function(a){var b,c,d,e="",f=a.getElementsByTagName("tr");for(b=0;b<f.length;b++){for(e="odd"==e?"even":"odd",f[b].className=e,c=new Array,d=0;d<f[b].childNodes.length;d++)1==f[b].childNodes[d].nodeType&&c.push(f[b].childNodes[d]);for(d=0;d<c.length;d++)c[d].row=b,c[d].col=d,("&nbsp;"==c[d].innerHTML||""==c[d].innerHTML)&&(c[d].className+=" empty"),c[d].css=c[d].className,c[d].onmouseover=function(){over(a,this,this.row,this.col)},c[d].onmouseout=function(){out(a,this,this.row,this.col)},c[d].onmousedown=function(){down(a,this,this.row,this.col)},c[d].onmouseup=function(){up(a,this,this.row,this.col)},c[d].onclick=function(){click(a,this,this.row,this.col)}}},this.over=function(a,d,e,f){b||c||(d.className=d.css+" over"),check1(d,f)&&(b&&highlightCol(a,d,f),c&&highlightRow(a,d,e))},this.out=function(a,d,e,f){b||c||(d.className=d.css),unhighlightCol(a,f),unhighlightRow(a,e)},this.down=function(a,b){b.className=b.css+" down"},this.up=function(a,b){b.className=b.css+" over"},this.click=function(a,e,f,g){check1&&d&&(unselect(a),b&&highlightCol(a,e,g,!0),c&&highlightRow(a,e,f,!0),document.onclick=unselectAll),clickAction(e)},this.highlightCol=function(a,b,c,d){var e,f,g,h="undefined"!=typeof d?"selected":"over",i=a.getElementsByTagName("tr");for(e=0;e<i.length;e++){for(f=new Array,j=0;j<i[e].childNodes.length;j++)1==i[e].childNodes[j].nodeType&&f.push(i[e].childNodes[j]);g=f[c],check2(b,g)&&check3(g)&&(g.className=g.css+" "+h)}},this.unhighlightCol=function(a,b){var c,d,e,f=a.getElementsByTagName("tr");for(c=0;c<f.length;c++){for(d=new Array,j=0;j<f[c].childNodes.length;j++)1==f[c].childNodes[j].nodeType&&d.push(f[c].childNodes[j]);e=d[b],check3(e)&&(e.className=e.css)}},this.highlightRow=function(a,b,c,d){var e,f,g="undefined"!=typeof d?"selected":"over",h=a.getElementsByTagName("tr")[c];for(e=0;e<h.childNodes.length;e++)f=h.childNodes[e],check2(b,f)&&check3(f)&&(f.className=f.css+" "+g)},this.unhighlightRow=function(a,b){var c,d,e=a.getElementsByTagName("tr")[b];for(c=0;c<e.childNodes.length;c++)d=e.childNodes[c],check3(d)&&(d.className=d.css)},this.unselect=function(a){var b,c,d;for(tr=a.getElementsByTagName("tr"),b=0;b<tr.length;b++)for(c=0;c<tr[b].childNodes.length;c++)d=tr[b].childNodes[c],d.className&&(d.className=d.className.replace("selected",""))},this.unselectAll=function(){if(!a){tables=document.getElementsByClassName("scoresTable");for(var b=0;b<tables.length;b++)unselect(tables[b])}},this.check1=function(a,b){return!(0==b&&-1!=a.className.indexOf("empty"))},this.check2=function(a,b){return!("TH"==a.tagName&&"TH"==b.tagName)},this.check3=function(a){return a.className?-1==a.className.indexOf("selected"):!0},start()},PaperTemplate=function(a,b,c){this._quesTypeTemplate=JSON.parse(b),this._domainAnalysisTemplate=JSON.parse(c),this._questionTypeIndexes=null,this._domainAnalysisIndexes=null,this._fullScore=a,PaperTemplate.prototype.initTemplate=function(){this._questionTypeIndexes=this._quesTypeTemplate.index,this._domainAnalysisIndexes=this._domainAnalysisTemplate.index},PaperTemplate.prototype.isValid=function(){return null!=this._quesTypeTemplate&&null!=this._domainAnalysisTemplate}},Scores=function(a,b,c,d,e){this._selfScore=b,this._paperTemplate=a,this._selfDetail=JSON.parse(c),this._schoolDetail=JSON.parse(d),this._regionDetail=JSON.parse(e),Scores.shared_scoreLabels=["本题分数","学校平均成绩","全省平均成绩","您的成绩"],Scores.shared_domainLabels=["题数","您学校平均答对题数","全省平均答对题数","您答对的题数"],Scores.shared_mapNames=["0","1","2","3"],Scores.prototype.getMappedSumScore=function(a,b){var c={};return c.label="总分",c[Scores.shared_mapNames[0]]=this._paperTemplate._fullScore,c[Scores.shared_mapNames[1]]=a,c[Scores.shared_mapNames[2]]=b,c[Scores.shared_mapNames[3]]=this._selfScore,c},Scores.prototype.getMappedQuestionTypeScoreDataset=function(){var a,b,c,d,e=[],f=0,g=0,h=this._paperTemplate._questionTypeIndexes;for(a=0;a<h.length;++a)b={},b.label=h[a],b[Scores.shared_mapNames[0]]=this._paperTemplate._quesTypeTemplate[h[a]].score,b[Scores.shared_mapNames[3]]=this._selfDetail[h[a]].score,c=this._schoolDetail[h[a]].avgscore/this._schoolDetail.totalcount,f+=c,d=this._regionDetail[h[a]].avgscore/this._regionDetail.totalcount,g+=d,b[Scores.shared_mapNames[1]]=c,b[Scores.shared_mapNames[2]]=d,e.push(b);return e.push(this.getMappedSumScore(f,g)),e},Scores.prototype.getMappedSumDomainCount=function(a){var b,c={};for(c.label="总题数",b=0;b<Scores.shared_mapNames.length;++b)c[Scores.shared_mapNames[b]]=a[b];return c},Scores.prototype.getMappedDomainAnalysisDataset=function(){var a,b,c,d,e,f,g=[],h=[0,0,0,0],i=this._paperTemplate._domainAnalysisIndexes;for(a=0;a<i.length;++a)b={},b.label=i[a],c=this._paperTemplate._domainAnalysisTemplate[i[a]].count,h[0]+=c,b[Scores.shared_mapNames[0]]=c,d=this._selfDetail[i[a]].count,h[3]+=d,b[Scores.shared_mapNames[3]]=d,e=this._schoolDetail[i[a]].avgcount/this._schoolDetail.totalcount,h[1]+=e,b[Scores.shared_mapNames[1]]=e,f=this._regionDetail[i[a]].avgcount/this._regionDetail.totalcount,h[2]+=f,b[Scores.shared_mapNames[2]]=f,g.push(b);return g.push(this.getMappedSumDomainCount(h)),g}},gShared_accuracy=[],gShared_domainNames=[];